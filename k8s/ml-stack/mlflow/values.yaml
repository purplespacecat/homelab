# MLflow Deployment Configuration
# Note: Using community chart from community-charts/mlflow

# Tracking server configuration
trackingServer:
  image:
    repository: ghcr.io/mlflow/mlflow
    tag: "latest"
    pullPolicy: IfNotPresent

  # Backend store (SQLite for simplicity, PostgreSQL for production)
  backendStore:
    type: sqlite
    # For production, use PostgreSQL:
    # type: postgresql
    # host: postgresql.mlflow.svc.cluster.local
    # port: 5432
    # database: mlflow
    # username: mlflow
    # password: changeme

  # Artifact store (local file system)
  artifactRoot: /mlflow/artifacts

  # Service configuration
  service:
    type: LoadBalancer  # MetalLB
    port: 5000

  # Ingress
  ingress:
    enabled: true
    className: nginx
    annotations:
      nginx.ingress.kubernetes.io/ssl-redirect: "false"
    hosts:
      - host: mlflow.192.168.100.98.nip.io  # Node IP where NGINX Ingress listens
        paths:
          - path: /
            pathType: Prefix
    tls: []

  # Persistence for artifacts and database
  persistence:
    enabled: true
    storageClass: nfs-client
    accessModes:
      - ReadWriteOnce
    size: 20Gi

  # Resources
  resources:
    requests:
      cpu: 250m
      memory: 512Mi
    limits:
      cpu: 1000m
      memory: 2Gi

  # Environment variables
  extraEnv:
    - name: MLFLOW_TRACKING_URI
      value: "http://mlflow.mlflow.svc.cluster.local:5000"

# Note: If using community chart is not available, use the deployment below
